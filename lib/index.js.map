{"version":3,"sources":["webpack://stocache/webpack/universalModuleDefinition","webpack://stocache/./src/index.js","webpack://stocache/webpack/bootstrap","webpack://stocache/webpack/startup"],"names":["root","factory","exports","module","define","amd","self","this","config","support","key","window","setItem","JSON","stringify","parse","getItem","e","scope","storageType","exception","generator","value","input","code","i","length","charCodeAt","Math","abs","name","message","json","encode","fallback","decode","storage","set","unset","removeItem","get","middleware","now","floor","Date","keys","shadow","context","object","remove","add","commit","keep","ttl","condition","has","parseInt","clean","flush","expireSoon","changed","expireSoonKey","expireSoonTime","Object","writed","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"stocache\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"stocache\"] = factory();\n\telse\n\t\troot[\"stocache\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn ","const config = {\n    scope: 'stocache',\n    ttl: 60,\n    exception: false,\n    storageType: 'localStorage',\n}\n\nconst support = ((key) => {\n    try {\n        window[config.storageType].setItem(key, JSON.stringify(true))\n        return JSON.parse(window[config.storageType].getItem(key))\n    } catch (e) {\n        return false\n    }\n})(config.scope + '-' + 'support')\n\nconst Stocache = (scope = config.scope, storageType = config.storageType, exception = config.exception) => {\n    storageType = storageType == 'localStorage' || storageType == 'sessionStorage' ? storageType : config.storageType\n\n    const generator = (scope) => {\n        const key = (value = scope) => {\n            let input = value === null ? scope : value\n            let code = 0\n            for (let i = 0; i < input.length; i++) {\n                code = (code << 5) - code + input.charCodeAt(i)\n                code = code & code\n            }\n            return scope + '-' + (code > 0 ? code : 'i' + Math.abs(code))\n        }\n\n        const exception = (name = null, message = null) => {\n            return {\n                scope,\n                name,\n                message,\n            }\n        }\n\n        return { key, exception }\n    }\n\n    const json = (value) => {\n        const encode = (fallback = '') => {\n            try {\n                return JSON.stringify(value)\n            } catch ({ message }) {\n                if (exception) throw generator(scope).exception('json.encode', message)\n                return fallback\n            }\n        }\n\n        const decode = (fallback = {}) => {\n            try {\n                return JSON.parse(value)\n            } catch ({ message }) {\n                if (exception) throw generator(scope).exception('json.decode', message)\n                return fallback\n            }\n        }\n\n        return { encode, decode }\n    }\n\n    const storage = (key = scope) => {\n        const set = (value = null) => {\n            try {\n                window[storageType].setItem(key, json(value).encode())\n                return true\n            } catch ({ message }) {\n                if (exception) throw generator(scope).exception('storage.set', message)\n                return false\n            }\n        }\n\n        const unset = () => {\n            try {\n                window[storageType].removeItem(key)\n                return true\n            } catch ({ message }) {\n                if (exception) throw generator(scope).exception('storage.unset', message)\n                return false\n            }\n        }\n\n        const get = (fallback = false) => {\n            return json(window[storageType].getItem(key)).decode(fallback)\n        }\n\n        return { set, unset, get }\n    }\n\n    const middleware = (key = scope, now = Math.floor(Date.now() / 1000)) => {\n        let keys = {\n            shadow: generator(scope).key(),\n            storage: generator(scope).key(key),\n        }\n\n        let context = {\n            object: storage(keys.shadow).get() || {},\n            remove: (key) => {\n                delete context.object[key]\n                return true\n            },\n            add: (key, value) => {\n                context.object[key] = value\n                return true\n            },\n        }\n\n        const commit = () => {\n            if (support) {\n                return storage(keys.shadow).set(context.object)\n            }\n            return false\n        }\n\n        const unset = (key = keys.storage) => {\n            if (support) {\n                return context.remove(key) && commit() && storage(key).unset()\n            }\n            return false\n        }\n\n        const keep = (ttl, condition = has(keys.storage)) => {\n            if (support && condition) {\n                return context.add(keys.storage, now + parseInt(ttl)) && commit()\n            }\n            return false\n        }\n\n        const has = (key = keys.storage) => {\n            if (clean() && context.object[key]) {\n                return context.object[key] - now\n            }\n            return false\n        }\n\n        const get = (fallback) => {\n            if (has(keys.storage)) {\n                return storage(keys.storage).get(fallback)\n            } else {\n                return fallback\n            }\n        }\n\n        const clean = (flush = false, expireSoon = false) => {\n            let changed = false\n            let expireSoonKey = null\n            let expireSoonTime = 0\n            for (let key of Object.keys(context.object)) {\n                if (flush || context.object[key] < now) {\n                    changed = true\n                    context.remove(key)\n                    storage(key).unset()\n                } else if (expireSoon && (expireSoonTime === 0 || expireSoonTime > context.object[key])) {\n                    changed = true\n                    expireSoonKey = key\n                    expireSoonTime = context.object[key]\n                }\n            }\n            return changed ? unset(expireSoonKey) : true\n        }\n\n        const set = (value, ttl) => {\n            if (support) {\n                if (scope === key) {\n                    if (exception) throw generator(scope).exception('middleware.set', 'KeyConflict')\n                } else {\n                    let writed = storage(keys.storage).set(value)\n                    if (!writed) {\n                        clean()\n                        writed = storage(keys.storage).set(value)\n                    }\n                    if (!writed) {\n                        clean(false, true)\n                        writed = storage(keys.storage).set(value)\n                    }\n                    if (!writed) {\n                        clean(true)\n                        writed = storage(keys.storage).set(value)\n                    }\n                    return writed ? keep(ttl, true) : false\n                }\n            }\n            return false\n        }\n\n        return { set, unset, has, keep, get }\n    }\n\n    return {\n        set: (key = null, value = null, ttl = config.ttl) => middleware(key).set(value, ttl),\n        unset: (key = null) => middleware(key).unset(),\n        has: (key = null) => middleware(key).has(),\n        keep: (key = null, ttl = config.ttl) => middleware(key).keep(ttl),\n        get: (key = null, fallback = false) => middleware(key).get(fallback),\n        flush: (scope = config.scope) => middleware(scope).clean(true),\n    }\n}\n\nexport default Stocache\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(579);\n"],"sourceRoot":""}